<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guardiantix Register</title>
  <style>
    body {
      margin: 0;
      font-family: 'Georgia', serif;
      background: linear-gradient(135deg, #2E2A30 0%, #1a1a2e 100%);
      color: #FDF6E3;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    /* Magical background effects */
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 20%, rgba(199, 62, 62, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(200, 162, 200, 0.08) 0%, transparent 60%);
      z-index: -1;
    }

    .register-container {
      background: linear-gradient(145deg, #1a1a2e, #2E2A30);
      padding: 2.5rem;
      border-radius: 15px;
      width: 400px;
      text-align: center;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.5),
        0 0 20px rgba(255, 215, 0, 0.2);
      border: 2px solid #FFD700;
      position: relative;
      z-index: 1;
    }

    .register-container::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, #FFD700, #C73E3E, #C8A2C8, #FFD700);
      border-radius: 17px;
      z-index: -1;
      opacity: 0.3;
    }

    .logo {
      color: #FFD700;
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }

    .register-container h1 { 
      font-size: 1.8rem; 
      margin-bottom: 0.5rem; 
      color: #FFD700; 
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }
    
    .register-container p { 
      font-size: 0.95rem; 
      margin-bottom: 1.5rem; 
      color: #C8A2C8; 
    }
    
    .register-container label { 
      display: block; 
      text-align: left; 
      margin-bottom: 0.5rem; 
      font-weight: bold; 
      color: #FFD700; 
      font-size: 0.9rem;
    }
    
    .register-container input { 
      width: 100%; 
      padding: 0.75rem; 
      margin-bottom: 1rem; 
      border: 2px solid #C8A2C8; 
      border-radius: 8px; 
      background: #2E2A30; 
      color: #FDF6E3; 
      font-family: 'Georgia', serif;
      font-size: 0.9rem;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }

    .register-container input:focus {
      outline: none;
      border-color: #FFD700;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
      background: #1a1a2e;
      transform: scale(1.02);
    }

    .register-container input::placeholder {
      color: #C8A2C8;
      opacity: 0.7;
    }
    
    .register-container button { 
      width: 100%; 
      padding: 0.85rem; 
      background: linear-gradient(135deg, #C73E3E, #A52A2A);
      border: 2px solid #FFD700;
      border-radius: 8px; 
      font-weight: bold; 
      cursor: pointer; 
      color: #FDF6E3; 
      font-family: 'Georgia', serif;
      font-size: 1rem;
      transition: all 0.3s ease;
      margin-top: 0.5rem;
    }
    
    .register-container button:hover { 
      background: linear-gradient(135deg, #FFD700, #D4AC0D);
      color: #2E2A30;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
    }

    .register-container button:active {
      transform: translateY(0);
    }

    .login-link { 
      margin-top: 1.5rem; 
      font-size: 0.9rem; 
      color: #C8A2C8;
    }
    
    .login-link a { 
      color: #FFD700; 
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }

    .login-link a:hover { 
      color: #C8A2C8; 
      text-decoration: underline;
    }

    .password-hint {
      text-align: left;
      font-size: 0.8rem;
      color: #C8A2C8;
      margin-top: -0.5rem;
      margin-bottom: 1rem;
    }

    .error-message {
      color: #C73E3E;
      background: rgba(199, 62, 62, 0.1);
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #C73E3E;
      margin-bottom: 15px;
      display: none;
    }

    .success-message {
      color: #FFD700;
      background: rgba(255, 215, 0, 0.1);
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #FFD700;
      margin-bottom: 15px;
      display: none;
    }

    /* Animation for magical effect */
    @keyframes glow {
      0%, 100% { 
        box-shadow: 
          0 10px 30px rgba(0, 0, 0, 0.5),
          0 0 20px rgba(255, 215, 0, 0.3);
      }
      50% { 
        box-shadow: 
          0 10px 30px rgba(0, 0, 0, 0.5),
          0 0 30px rgba(255, 215, 0, 0.5);
      }
    }

    .register-container {
      animation: glow 3s ease-in-out infinite;
    }
  </style>
</head>
<body>

  <div class="register-container">
    <div class="logo">GuardianTix</div>
    <h1>Join the Magic</h1>
    <p>Create your enchanted account to begin your journey</p>

    <div class="error-message" id="errorMessage"></div>
    <div class="success-message" id="successMessage"></div>

    <form id="registerForm">
      <label for="username">Wizard Name</label>
      <input type="text" id="username" placeholder="Enter your magical username" required>

      <label for="email">Owl Post Address</label>
      <input type="email" id="email" placeholder="wizard@guardiantix.com" required>

      <label for="password">Secret Spell</label>
      <input type="password" id="password" placeholder="Create your magical password" required>
      <div class="password-hint">Must contain at least 8 magical characters</div>

      <label for="confirm">Confirm Secret Spell</label>
      <input type="password" id="confirm" placeholder="Repeat your magical password" required>

      <button type="submit">Create Magical Account</button>
    </form>

    <div class="login-link">
      Already part of the magic? <a href="login.html">Sign in here</a>
    </div>
  </div>

  <script>
    // Authentication System
    class AuthSystem {
      constructor() {
        this.users = JSON.parse(localStorage.getItem('guardiantix_users')) || [];
        this.currentUser = JSON.parse(localStorage.getItem('guardiantix_current_user')) || null;
      }

      register(userData) {
        // Check if user already exists
        if (this.users.find(u => u.email === userData.email)) {
          return { success: false, message: 'A wizard already exists with this owl post address!' };
        }

        if (userData.password.length < 8) {
          return { success: false, message: 'Secret spell must be at least 8 magical characters long!' };
        }

        if (userData.password !== userData.confirmPassword) {
          return { success: false, message: 'Secret spells do not match!' };
        }

        const newUser = {
          id: Date.now().toString(),
          username: userData.username,
          email: userData.email,
          password: userData.password,
          joinDate: new Date().toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
          }),
          phone: userData.phone || ''
        };

        this.users.push(newUser);
        localStorage.setItem('guardiantix_users', JSON.stringify(this.users));

        // TIDAK auto login setelah register
        // Hanya simpan data user, tidak set current user
        return { success: true, user: newUser };
      }

      isLoggedIn() {
        return this.currentUser !== null;
      }
    }

    const auth = new AuthSystem();
    const errorMessage = document.getElementById("errorMessage");
    const successMessage = document.getElementById("successMessage");

    // Check if already logged in
    if (auth.isLoggedIn()) {
      window.location.href = 'homepage.html';
    }

    // Real-time password matching
    document.addEventListener('DOMContentLoaded', function() {
      const password = document.getElementById('password');
      const confirm = document.getElementById('confirm');
      
      function validatePasswords() {
        if(password.value && confirm.value && password.value !== confirm.value) {
          confirm.style.borderColor = '#C73E3E';
          confirm.style.boxShadow = '0 0 10px rgba(199, 62, 62, 0.3)';
        } else if(password.value && confirm.value && password.value === confirm.value) {
          confirm.style.borderColor = '#FFD700';
          confirm.style.boxShadow = '0 0 10px rgba(255, 215, 0, 0.3)';
        }
      }
      
      password.addEventListener('input', validatePasswords);
      confirm.addEventListener('input', validatePasswords);
    });

    const form = document.getElementById("registerForm");
    form.addEventListener("submit", function(e){
      e.preventDefault();
      const username = document.getElementById("username").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirm").value;

      // Basic validation
      if (!username || !email || !password || !confirmPassword) {
        errorMessage.textContent = 'Please fill in all magical fields!';
        errorMessage.style.display = 'block';
        return;
      }

      const result = auth.register({
        username,
        email,
        password,
        confirmPassword
      });

      if (result.success) {
        // Add magical loading effect
        const button = document.querySelector('button[type="submit"]');
        const originalText = button.textContent;
        button.textContent = 'Casting Registration Spell...';
        button.disabled = true;

        // Show success message
        errorMessage.style.display = 'none';
        successMessage.textContent = 'âœ¨ Magical account created successfully! Redirecting to login...';
        successMessage.style.display = 'block';

        setTimeout(() => {
          // Redirect to login page dengan parameter success
          window.location.href = "login.html?registered=true";
        }, 2000);
      } else {
        errorMessage.textContent = result.message;
        errorMessage.style.display = 'block';
        successMessage.style.display = 'none';
      }
    });
  </script>
</body>
</html>